<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.2.2" />
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
}

strong {
  font-weight: bold;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1 {
  border-bottom: 2px solid silver;
}
h2 {
  border-bottom: 2px solid silver;
  padding-top: 0.5em;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revision {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble,
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-right: 10%;
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.5em;
  margin-bottom: 2.5em;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock {
  margin-right: 0%;
}
div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock > div.content {
  padding-left: 2.0em;
}

div.attribution {
  text-align: right;
}
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 2px solid silver;
}

div.exampleblock > div.content {
  border-left: 2px solid silver;
  padding: 0.5em;
}

div.verseblock div.content {
  white-space: pre;
}

div.imageblock div.content { padding-left: 0; }
div.imageblock img { border: 1px solid silver; }
span.image img { border-style: none; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: italic;
}
dd > *:first-child {
  margin-top: 0;
}

ul, ol {
    list-style-position: outside;
}
ol.olist2 {
  list-style-type: lower-alpha;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}

div.hlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hlist td {
  padding-bottom: 5px;
}
td.hlist1 {
  vertical-align: top;
  font-style: italic;
  padding-right: 0.8em;
}
td.hlist2 {
  vertical-align: top;
}

@media print {
  div#footer-badges { display: none; }
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-content {
  padding-left: 2.0em;
}

div.exampleblock-content {
  border-left: 2px solid silver;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
<script type="text/javascript">
/*<![CDATA[*/
window.onload = function(){generateToc(2)}
/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4.sp
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, October 2006. License: GPL */
 /* modified by Shawn Pearce, August 2009. License: GPL */

function getText(el) {
  var text = "";
  for (var i = el.firstChild; i != null; i = i.nextSibling) {
    if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
      text += i.data;
    else if (i.firstChild != null)
      text += getText(i);
  }
  return text;
}

function TocEntry(el, text, toclevel) {
  this.element = el;
  this.text = text;
  this.toclevel = toclevel;
  this.assigned = false;

  if (el.id != '') {
    this.id = el.id;

  } else {
    var a = el.firstChild;
    if ((a.tagName == "a" || a.tagName == "A") && a.id != "") {
      this.id = a.id;
    } else {
      this.id = '';
    }
  }
}

function tocEntries(el, toclevels) {
  var result = new Array;
  var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
  // Function that scans the DOM tree for header elements (the DOM2
  // nodeIterator API would be a better technique but not supported by all
  // browsers).
  var iterate = function (el) {
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
        var mo = re.exec(i.tagName)
        if (mo)
          result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
        iterate(i);
      }
    }
  }
  iterate(el);
  return result;
}

// This function does the work. toclevels = 1..4.
function generateToc(toclevels) {
  var simple_re = new RegExp('^[a-zA-Z._ -]{1,}$');
  var entries = tocEntries(document.getElementsByTagName("body")[0], toclevels);
  var usedIds = new Array();

  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.id != "")
      usedIds[entry.id] = entry;
  }

  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.id != "" || !simple_re.exec(entry.text))
      continue;

    var n = entry.text.replace(/ /g, '_').toLowerCase();
    var e = usedIds[n];
    if (e) {
      if (e.assigned)
        e.id = '';
      continue;
    }

    entry.assigned = true;
    entry.id = n;
    entry.element.id = entry.id;
    usedIds[n] = entry;
  }

  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.id == '') {
      entry.id = "toc" + i;
      entry.element.id = entry.id;
    }
  }

  var toc = document.getElementById("toc");
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    var a = document.createElement("a");
    a.href = "#" + entry.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
}
/*]]>*/
</script>
<title>Gerrit Code Review - Mail Templates</title>
</head>
<body>
<div id="header">
<h1>Gerrit Code Review - Mail Templates</h1>
<span id="revision">version 2.1.6</span>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="preamble">
<div class="sectionbody">
<p>Gerrit uses velocity templates for the bulk of the standard mails it sends out.
There are builtin default templates which are used if they are not overridden.
These defaults are also provided as examples so that administrators may copy
them and easily modify them to tweak their contents.</p>
</div>
</div>
<h2>Template Locations and Extensions:</h2>
<div class="sectionbody">
<p>The default example templates reside under:  <tt><em>$site_path</em>/etc/mail</tt> and are
terminated with the double extension <tt>.vm.example</tt>. Modifying these example
files will have no effect on the behavior of Gerrit.  However, copying an
example template to an equivalently named file without the <tt>.example</tt> extension
and modifying it will allow an administrator to customize the template.</p>
</div>
<h2>Supported Mail Templates:</h2>
<div class="sectionbody">
<p>Each mail that Gerrit sends out is controlled by at least one template, these
are listed below.  Change emails are influenced by two additional templates,
one to set the subject line, and one to set the footer which gets appended to
all the change emails (see <tt>ChangeSubject.vm</tt> and <tt>ChangeFooter.vm</tt> below.)</p>
<h3>Abandoned.vm</h3>
<p>The <tt>Abandoned.vm</tt> template will determine the contents of the email related
to a change being abandoned.  It is a <tt>ChangeEmail</tt>: see <tt>ChangeSubject.vm</tt> and
<tt>ChangeFooter.vm</tt>.</p>
<h3>ChangeFooter.vm</h3>
<p>The <tt>ChangeFooter.vm</tt> template will determine the contents of the footer
text that will be appended to emails related to changes (all <tt>ChangeEmails)</tt>.</p>
<h3>ChangeSubject.vm</h3>
<p>The <tt>ChangeSubject.vm</tt> template will determine the contents of the email
subject line for ALL emails related to changes.</p>
<h3>Comment.vm</h3>
<p>The <tt>Comment.vm</tt> template will determine the contents of the email related to
a user submitting comments on changes.  It is a <tt>ChangeEmail</tt>: see</p>
<h3>Merged.vm</h3>
<p>The <tt>Merged.vm</tt> template will determine the contents of the email related to
a change successfully merged to the head.  It is a <tt>ChangeEmail</tt>: see
<tt>ChangeSubject.vm</tt> and <tt>ChangeFooter.vm</tt>.</p>
<h3>MergeFail.vm</h3>
<p>The <tt>MergeFail.vm</tt> template will determine the contents of the email related
to a failure upon attempting to merge a change to the head.  It is a</p>
<h3>NewChange.vm</h3>
<p>The <tt>NewChange.vm</tt> template will determine the contents of the email related
to a user submitting a new change for review. It is a <tt>ChangeEmail</tt>: see
<tt>ChangeSubject.vm</tt> and <tt>ChangeFooter.vm</tt>.</p>
<h3>RegisterNewEmail.vm</h3>
<p>The <tt>RegisterNewEmail.vm</tt> template will determine the contents of the email
related to registering new email accounts.</p>
<h3>ReplacePatchSet.vm</h3>
<p>The <tt>ReplacePatchSet.vm</tt> template will determine the contents of the email
related to a user submitting a new patchset for a change.  It is a
<tt>ChangeEmail</tt>: see <tt>ChangeSubject.vm</tt> and <tt>ChangeFooter.vm</tt>.</p>
</div>
<h2>Mail Variables and Methods</h2>
<div class="sectionbody">
<p>Mail templates can access and display objects currently made available to them
via the velocity context.  While the base objects are documented here, it is
possible to call public methods on these objects from templates.  Those methods
are not documented here since they could change with every release.  As these
templates are meant to be modified only by a qualified sysadmin, it is accepted
that writing templates for Gerrit emails is likely to require some basic
knowledge of the class structure to be useful.  Browsing the source code might
be necessary for anything more than a minor formatting change.</p>
<h3>Warning</h3>
<p>Be aware that modifying templates can cause them to fail to parse and therefor
not send out the actual email, or worse, calling methods on the available
objects could have internal side effects which would adversely affect the
health of your Gerrit server and/or data.</p>
<h3>All OutgoingEmails</h3>
<p>All outgoing emails have the following variables available to them:</p>
<dl>
<dt>
$email
</dt>
<dd>
<p>A reference to the class constructing the current <tt>OutgoingEmail</tt>.  With this
reference it is possible to call any public method on the OutgoingEmail class
or the current child class inherited from it.</p>
</dd>
<dt>
$messageClass
</dt>
<dd>
<p>A String containing the messageClass</p>
</dd>
<dt>
$StringUtils
</dt>
<dd>
<p>A reference to the Apache <tt>StringUtils</tt> class.  This can be very useful for
formatting strings.</p>
</dd>
</dl>
<h3>Change Emails</h3>
<p>All change related emails have the following additional variables available to them:</p>
<dl>
<dt>
$change
</dt>
<dd>
<p>A reference to the current <tt>Change</tt> object</p>
</dd>
<dt>
$changeId
</dt>
<dd>
<p>Id of the current change (a <tt>Change.Key</tt>)</p>
</dd>
<dt>
$coverLetter
</dt>
<dd>
<p>The text of the <tt>ChangeMessage</tt></p>
</dd>
<dt>
$branch
</dt>
<dd>
<p>A reference to the branch of this change (a <tt>Branch.NameKey</tt>)</p>
</dd>
<dt>
$fromName
</dt>
<dd>
<p>The name of the from user</p>
</dd>
<dt>
$projectName
</dt>
<dd>
<p>The name of this change's project</p>
</dd>
<dt>
$patchSet
</dt>
<dd>
<p>A reference to the current <tt>PatchSet</tt></p>
</dd>
<dt>
$patchSetInfo
</dt>
<dd>
<p>A reference to the current <tt>PatchSetInfo</tt></p>
</dd>
</dl>
</div>
<h2>See Also</h2>
<div class="sectionbody">
<ul>
<li>
<p>
<a href="http://velocity.apache.org/">velocity</a>
</p>
</li>
</ul>
</div>
<hr style="
  height: 2px;
  color: silver;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
">
<p>Part of <a href="index.html">Gerrit Code Review</a></p>
<div id="footer">
<div id="footer-text">
Version 2.1.6<br />
Last updated 08-Dec-2010 15:40:54 PDT
</div>
</div>
</body>
</html>
